@model AIChatDiscordBotWeb.Models.EnvConfig

@{
    ViewBag.Title = "Configuration";
    // Convert list of ulong IDs into a comma-separated string for editing
    string allowedChannels = string.Join(",", Model.ALLOWED_CHANNEL_IDS ?? new List<ulong>());
}

<h2>Bot Configuration</h2>

<form asp-action="Save" method="post">
    <div class="mb-3">
        <label>Bot Token</label>
        <input asp-for="BOT_TOKEN" type="password" id="token" class="form-control" value="@Model.BOT_TOKEN" />
        <input type="checkbox" onclick="tokenShow()">Show bot token
        <p>Get your custom bot token from <a href="https://discord.com/developers/applications">here</a> </p>
    </div>

    <div class="mb-3">
        <label>Local Host</label>
        <input asp-for="LOCAL_HOST" class="form-control" />
        <p>Example: http://localhost:11434 (this is default numbers for ollama if you didnt change to custom)</p>
    </div>

    <div class="mb-3">
        <label>Model</label>
        <input asp-for="MODEL" class="form-control" />
        <p>Write the whole name as shown in ollama</p>
    </div>

    <div class="mb-3">
        <label>Allowed Channel IDs</label>
        <input name="AllowedChannelIdsInput" value="@allowedChannels" class="form-control" />
        <p>Comma separated for more than one  Example: 12456, 2345</p>
    </div>

    <div class="mb-3">
        <label>System Message</label>
        <textarea asp-for="SYSTEM_MESSAGE" class="form-control" style="height:100px;"></textarea>
    </div>

    <div class="mb-3">
        <label>Serper web api key</label>
        <input asp-for="SERPER_API_KEY" type="password" id="serper" class="form-control" value="@Model.SERPER_API_KEY" />
        <input type="checkbox" onclick="serperShow()">Show Serper API
        <p>Get your custom api key for web search from <a href="https://serper.dev/api-keys">here</a> </p>
    </div>

    <div class="mb-3">
        <h4>ComfyUI config</h4>
        <label>ComfyUI Api</label>
        <input asp-for="COMFYUI_API" class="form-control" />
        <p>Example: http://127.0.0.1:8000 (this is default numbers for ComfyUI api if you didnt change to custom)</p>
    </div>

    <div class="mb-3">
        <label>ComfyUI path to the generated images</label>
        <input asp-for="COMFYUI_IMAGE_PATH" class="form-control" />
        <p>Example: C:\Users\YourPCName\Documents\ComfyUI\output (this is default numbers for ComfyUI image generation folder if you didnt change to custom)</p>
    </div>
    <p style="color:red">After you press the save button restart the whole program for the changes to apply.</p>
    <button type="submit" class="btn btn-primary">Save</button>

    <script>
        function tokenShow() {
          var x = document.getElementById("token");
          if (x.type === "password") {
            x.type = "text";
          } else {
            x.type = "password";
          }
        }

        function serperShow() {
          var x = document.getElementById("serper");
          if (x.type === "password") {
            x.type = "text";
          } else {
            x.type = "password";
          }
        }
    </script>
</form>
